<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Orient Finance Co-Browse — Secure screen sharing with your advisor">
  <title>Orient Finance Co-Browse</title>
  <link rel="icon" href="/static/orient-finance-logo.png" type="image/png">
  <link rel="stylesheet" href="/static/main.css?v=1">
</head>
<body>
  <div id="app" class="app">
    <!-- LANDING (/) -->
    <main id="view-landing" class="view" role="main" aria-label="Landing page">
      <header class="header" role="banner">
        <div class="header-inner">
          <img src="/static/orient-finance-logo.png" alt="Orient Finance" class="logo" width="120" height="48" aria-hidden="false">
          <div>
            <h1 class="brand-title">Orient Finance Co-Browse</h1>
            <p class="brand-tagline" id="tagline">Secure screen sharing with your advisor</p>
          </div>
        </div>
      </header>

      <section class="hero">
        <h2 class="sr-only">Choose your role</h2>
        <div class="cards">
          <article class="card card-primary" aria-labelledby="card-client-head">
            <h3 id="card-client-head" class="card-title">Start a Support Session</h3>
            <p class="card-desc">Share your screen with your advisor securely.</p>
            <a href="/share" class="btn btn-primary" id="btn-start-sharing">Start Sharing</a>
          </article>
          <article class="card card-secondary" aria-labelledby="card-agent-head">
            <h3 id="card-agent-head" class="card-title">Join as Advisor</h3>
            <p class="card-desc">Enter the session code shared by your client.</p>
            <form id="join-form-landing" class="join-form" novalidate>
              <label for="input-session-code-landing" class="sr-only">Session code</label>
              <input type="text" id="input-session-code-landing" class="input" placeholder="Enter Session Code" required autocomplete="off" aria-describedby="join-landing-error">
              <button type="submit" class="btn btn-primary" id="btn-join-landing">Join Session</button>
              <div id="join-landing-error" class="error-text" role="alert" aria-live="polite"></div>
            </form>
          </article>
        </div>
      </section>
    </main>

    <!-- CLIENT SHARE WIZARD (/share) -->
    <main id="view-share" class="view view-hidden" role="main" aria-label="Share your screen">
      <header class="header header-compact">
        <a href="/" class="back-link" aria-label="Back to home">← Back</a>
        <span class="brand-compact" id="brand-compact-share">Orient Finance Co-Browse</span>
      </header>

      <div class="wizard">
        <div class="wizard-steps" aria-label="Progress">
          <div class="step-indicator" aria-current="step"><span>1</span> Prepare</div>
          <div class="step-indicator"><span>2</span> Share</div>
          <div class="step-indicator"><span>3</span> Live</div>
        </div>

        <!-- Step 1: Prepare -->
        <section id="share-step-1" class="wizard-step" data-step="1" aria-labelledby="step1-head">
          <h2 id="step1-head" class="step-head">Prepare to share</h2>
          <p class="step-desc">Your advisor will be able to see your screen in real time. You control when sharing starts and stops.</p>
          <div class="privacy-notice" role="note">
            <strong>Privacy notice:</strong> Only your screen is shared. You can stop anytime.
          </div>
          <button type="button" class="btn btn-primary" id="btn-step1-continue">Continue</button>
        </section>

        <!-- Step 2: Choose what to share -->
        <section id="share-step-2" class="wizard-step wizard-step-hidden" data-step="2" aria-labelledby="step2-head">
          <h2 id="step2-head" class="step-head">Choose what to share</h2>
          <p class="step-desc">Click the button below. Your browser will ask you to select a screen, window, or tab.</p>
          <button type="button" class="btn btn-primary" id="btn-start-screen-share">Start Screen Share</button>

          <div id="share-step2-code" class="share-code-block share-code-hidden">
            <p class="code-label">Share this code with your advisor</p>
            <div class="code-display">
              <span id="display-session-code" class="code-value" aria-live="polite"></span>
              <button type="button" class="btn btn-outline btn-copy" id="btn-copy-code" aria-label="Copy session code">Copy</button>
            </div>
            <div id="qrcode-container" class="qrcode-container"></div>
            <p class="code-hint">Your advisor can scan the QR code or enter the code manually.</p>
          </div>
        </section>

        <!-- Step 3: Sharing live -->
        <section id="share-step-3" class="wizard-step wizard-step-hidden" data-step="3" aria-labelledby="step3-head">
          <h2 id="step3-head" class="step-head">Sharing live</h2>
          <div class="status-badge status-live" aria-live="polite">● Sharing live</div>
          <div class="share-preview">
            <video id="preview-video" autoplay playsinline muted aria-label="Screen preview"></video>
            <div id="share-no-preview" class="share-no-preview">Sharing active</div>
          </div>
          <div class="share-code-inline">
            <span class="code-label">Session code:</span>
            <code id="display-session-code-live" class="code-value-inline" aria-live="polite"></code>
            <button type="button" class="btn btn-outline btn-copy" id="btn-copy-code-live">Copy</button>
          </div>
          <div class="share-actions">
            <button type="button" class="btn btn-outline btn-danger" id="btn-stop-sharing">Stop sharing</button>
          </div>
          <div class="conn-status" id="share-conn-status">
            <span id="share-peer-count">0</span> advisor(s) connected
          </div>
          <details class="troubleshoot">
            <summary>Troubleshooting</summary>
            <ul>
              <li>Ensure you've allowed screen sharing when prompted.</li>
              <li>Chrome, Edge, and Firefox on desktop work best.</li>
              <li>Screen sharing may not be supported on iOS Safari. Try Chrome/Edge on desktop.</li>
            </ul>
          </details>
        </section>
      </div>

      <div id="share-error" class="error-banner error-hidden" role="alert"></div>
    </main>

    <!-- ADVISOR JOIN (/join) -->
    <main id="view-join" class="view view-hidden" role="main" aria-label="Join session">
      <header class="header header-compact">
        <a href="/" class="back-link" aria-label="Back to home">← Back</a>
        <span class="brand-compact">Orient Finance Co-Browse</span>
      </header>

      <section class="join-section">
        <h2 class="join-head">Join as Advisor</h2>
        <p class="join-desc">Enter the session code your client shared with you.</p>
        <form id="join-form-page" class="join-form-standalone">
          <label for="input-session-code-join">Session Code</label>
          <input type="text" id="input-session-code-join" class="input input-lg" placeholder="e.g. admiring_happy_cat" required autocomplete="off">
          <button type="submit" class="btn btn-primary btn-block">Join Session</button>
        </form>
      </section>

      <div id="join-error" class="error-banner error-hidden" role="alert"></div>
    </main>

    <!-- ADVISOR VIEW (/view?room=) -->
    <main id="view-viewer" class="view view-hidden" role="main" aria-label="View shared screen">
      <header class="header header-compact">
        <a href="/" class="back-link" aria-label="Back to home">← Back</a>
        <span class="brand-compact">Orient Finance Co-Browse</span>
        <span id="viewer-status" class="status-badge status-waiting" aria-live="polite">Waiting for client</span>
      </header>

      <div class="viewer-area">
        <div class="viewer-video-wrap">
          <video id="main-video" autoplay playsinline controls aria-label="Shared screen"></video>
          <div id="viewer-placeholder" class="viewer-placeholder">
            <p>Waiting for client to start sharing...</p>
          </div>
        </div>
        <div class="viewer-controls">
          <button type="button" class="btn btn-outline" id="btn-fullscreen" aria-label="Toggle fullscreen">Fullscreen</button>
          <button type="button" class="btn btn-outline" id="btn-snapshot" aria-label="Take snapshot">Take snapshot</button>
          <details class="viewer-info">
            <summary>Connection info</summary>
            <dl class="info-list">
              <dt>Latency</dt>
              <dd id="info-latency">—</dd>
              <dt>Peers</dt>
              <dd id="info-peers">0</dd>
            </dl>
          </details>
        </div>
      </div>

      <div id="viewer-error" class="error-banner error-hidden" role="alert"></div>
    </main>
  </div>

  <footer class="footer" role="contentinfo">
    <p>© <span id="footer-brand">Orient Finance Broker</span> — Co-Browse</p>
    <a href="#" id="footer-privacy" class="footer-link">Security &amp; Privacy</a>
  </footer>

  <script src="/static/config.js"></script>
  <script src="/static/qrcode.min.js"></script>
  <script src="/static/main.js?v=1"></script>
</body>
</html>
